<!DOCTYPE html>
<html>

<head>
      <title>Leb NH Historic Tour</title>
      <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
      <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
      <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
      <style>
          html,
          body {
              height: 100%;
              width: 100%;
              margin: 0px;
          }
          #mapid{
            height: 100%;
            width: 100%;
            margin: 0px;
          }
      </style>
</head>

<body>
    <div id="mapid"></div>
    <script>
        // initialize map in div id="mapid" element
        var mymap = L.map('mapid'),
            // url template for our map provider
            osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
            // attribution that appears in right bottom corner of the map
            osmAttrib='Map Data and Text <a href="http://www.lebanonnhhistory.org/explore-lebanon/walking-tour-of-lebanon/">Lebanon Historical Society</a> | Base Map <a href="http://openstreetmap.org">OpenStreetMap</a> contributers',
            // create a tilelayer object for specific map data provider
            osm = new L.TileLayer(osmUrl, {
                minZoom: 12,
                maxZoom: 19,
                attribution: osmAttrib
            }).addTo(mymap),

            user_location,
            user_accuracy;

        // Get the user's location and sets view
        mymap.locate({
            setView: true,
            maxZoom: 19
        });

        // if location is found, call onLocationFound()
        mymap.on('locatonfound', onLocationFound);




        $.getJSON('tour.geojson', function(data){
            drawMap(data);
        });
        function drawMap(data) {
            var dataLayer = L.geoJSON( data, {
                pointToLayer: function(feature, latlng){
                    var marker = L.marker(latlng);
                    marker.bindPopup('<b>' + feature.properties.Name + '</b>'
                      + '<br/>' + feature.properties.description);
                    return marker;
                }
            }).addTo(mymap);






        }

        function onLocationFound(e) {
            var radius = e.accuracy / 2;
            user_location = L.marker(e.latlng).addTo(mymap)
                .bindPopup("You are here");

            user_accuracy = L.circle(e.latlng, radius).addTo(mymap);
        }






    </script>
</body>

</html>
